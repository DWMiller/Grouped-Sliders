(function(e){e.fn.groupedSliders=function(t){var n={startState:"unlocked",total:100};var r=e.extend({},n,t);return this.each(function(){var t=e(this);var n=t.find(".slider");n.addClass(r.startState);n.slider({range:"min",min:0,max:r.total,value:Math.floor(r.total/n.length),animate:"fast"});var i=function(){t.on("change",".slider-text",function(t){t.preventDefault();var n=e(this).next(".slider");var r=this.value;n.slider("value",r);n.trigger("slide")});t.on("click",".slider-lock",function(t){t.preventDefault();var n=e(this);f(n)});t.on("change",".slider-lock",function(t){value=e(this).val();e(this).next(".slider").slider("value",value)})}();var s=function(){t.on("slide slidechange",".slider",function(t){var n=e(this);n.addClass("clicked");a()})};s();var o=function(){sliderTotal=0;n.each(function(){var t=e(this).slider("option","value");sliderTotal+=t})};var u=function(){lockedTotal=0;n.filter(".locked").each(function(){var t=e(this).slider("option","value");lockedTotal+=t})};var a=function(){u();o();var i;t.off("slide slidechange",".slider");i=n.filter(".unlocked").not(".clicked");var a=n.filter(".clicked");var f=a.slider("option","value");if(i.length==0){a.slider("value",r.total-lockedTotal)}else if(f>r.total-lockedTotal){i.slider("value",0);a.slider("value",r.total-lockedTotal);sliderTotal=r.total}a.removeClass("clicked");var l=i.length;while(sliderTotal!=r.total&&i.length!=0){var c=Math.floor(Math.random()*i.length);var h=i.eq(c);var p=h.slider("option","value");var d=Math.ceil(Math.abs(sliderTotal-r.total)/l);if(sliderTotal>r.total){if(Math.abs(d)>p){d=p;i.splice(c,1)}d*=-1}if(p+d>=0&&p+d<=r.total){p+=d;sliderTotal+=d;h.slider("value",p)}else{}}e(".slider-text").val(function(){var t=e(this);var n=t.next(".slider").slider("option","value");return n});s()};a();var f=function(t){t.toggleClass("ui-icon-unlocked ui-icon-locked");var n=t.prev(".slider");n.toggleClass("unlocked locked");if(n.hasClass("unlocked")){n.slider("enable");e(n).prev("input").removeAttr("readonly")}else{n.slider("disable")}u();if(lockedTotal>=r.total){l()}};var l=function(){n.slider("disable").prev("input").attr("readonly","readonly");n.removeClass("unlocked");n.addClass("locked");n.next(".slider-lock").addClass("ui-icon-locked");n.next(".slider-lock").removeClass("ui-icon-unlocked");u()};var c=function(){n.slider("enable").prev("input").removeAttr("readonly");n.removeClass("locked");n.addClass("unlocked");n.next(".slider-lock").addClass("ui-icon-unlocked");n.next(".slider-lock").removeClass("ui-icon-locked");u()}})}})(jQuery)